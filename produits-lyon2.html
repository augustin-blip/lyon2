<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Produits Lyon 2 â€” Infos & AllergÃ¨nes</title>
<meta name="description" content="Liste des produits disponibles Ã  Lyon 2 avec ingrÃ©dients, allergÃ¨nes, Nutri-Score et Ã‰co-Score." />
<style>
  :root {
    --bg:#f6fdf8; --card:#ffffff; --muted:#476154; --text:#0b1f14;
    --accent:#22c55e; --accent-2:#10b981; --chip:#e8f7ee; --border:#def7e6; --ring:rgba(34,197,94,.35);
  }
  * { box-sizing:border-box; }
  body { margin:0; background:var(--bg); color:var(--text); font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; }
  header { position:sticky; top:0; z-index:20; backdrop-filter:saturate(1.2) blur(8px); background:rgba(246,253,248,.9); border-bottom:1px solid var(--border); }
  .container { max-width:1100px; margin:0 auto; padding:16px; }
  .title { display:flex; align-items:center; gap:12px; flex-wrap:wrap; }
  .logo, .brand-img { width:32px; height:32px; border-radius:8px; background:linear-gradient(135deg,var(--accent),var(--accent-2)); display:inline-flex; align-items:center; justify-content:center; color:white; font-weight:800; }
  .brand-img { background:none; }
  .brand-img img { max-height:32px; max-width:120px; height:auto; width:auto; display:block; object-fit:contain; }
  .title h1 { margin:0; font-size:1.15rem; }
  .badge { font-size:.75rem; padding:2px 8px; border-radius:999px; background:var(--chip); color:var(--muted); border:1px solid var(--border); }
  .ctrls { display:grid; grid-template-columns:1fr; gap:10px; margin-top:10px; }
  @media (min-width:720px) { .ctrls { grid-template-columns:1fr 200px 200px; } }
  input[type="search"], select { width:100%; padding:12px 14px; border-radius:12px; border:1px solid var(--border); background:var(--card); color:var(--text); outline:none; }
  input[type="search"]:focus, select:focus { box-shadow:0 0 0 4px var(--ring); border-color:var(--accent); }
  main.container { padding-top:12px; }
  .grid { display:grid; grid-template-columns:1fr; gap:14px; }
  @media (min-width:640px) { .grid { grid-template-columns:repeat(2,minmax(0,1fr)); } }
  @media (min-width:980px) { .grid { grid-template-columns:repeat(3,minmax(0,1fr)); } }
  .card { background:var(--card); border:1px solid var(--border); border-radius:16px; padding:14px; display:flex; flex-direction:column; gap:10px; box-shadow: 0 6px 16px rgba(34,197,94, .06); }
  .card h3 { margin:0; font-size:1.02rem; }
  .muted { color:var(--muted); font-size:.9rem; }
  .row { display:flex; align-items:center; gap:8px; flex-wrap:wrap; }
  .chip { background:var(--chip); border:1px solid var(--border); padding:2px 8px; border-radius:999px; font-size:.8rem; }
  .score { font-weight:700; padding:2px 8px; border-radius:8px; border:1px solid var(--border); background:var(--chip); }
  .score[data-type="nutri"][data-value="A"] { background:#eafbf0; border-color:#a7f3d0; }
  .score[data-type="nutri"][data-value="B"] { background:#f0fde8; border-color:#c7f9b5; }
  .score[data-type="nutri"][data-value="C"] { background:#fffbe6; border-color:#fde68a; }
  .score[data-type="nutri"][data-value="D"] { background:#fff1e6; border-color:#fdba74; }
  .score[data-type="nutri"][data-value="E"] { background:#ffecec; border-color:#fca5a5; }
  .score[data-type="eco"][data-value="A"] { background:#eafbf0; border-color:#a7f3d0; }
  .score[data-type="eco"][data-value="B"] { background:#f0fde8; border-color:#c7f9b5; }
  .score[data-type="eco"][data-value="C"] { background:#fffbe6; border-color:#fde68a; }
  .score[data-type="eco"][data-value="D"] { background:#fff1e6; border-color:#fdba74; }
  .score[data-type="eco"][data-value="E"] { background:#ffecec; border-color:#fca5a5; }
  .footer { text-align:center; color:var(--muted); font-size:.8rem; padding:20px 0 40px; }
  .empty { text-align:center; padding:40px; border:1px dashed var(--border); border-radius:16px; color:var(--muted); }
  .sr { position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); border:0; }
  .pill { display:inline-flex; align-items:center; gap:6px; padding:2px 8px; border-radius:999px; background:linear-gradient(135deg,var(--accent),var(--accent-2)); color:white; font-size:.8rem; font-weight:700; }
</style>
</head>
<body>
<header>
  <div class="container">
    <div class="title">
      <div id="brandSlot" class="logo">MG</div>
      <h1>Produits disponibles â€” Lyon 2</h1>
      <span class="badge">MAJ 2025-10-07</span>
      <span class="pill">My Green Shop</span>
    </div>
    <div class="ctrls" role="search">
      <label class="sr" for="q">Recherche</label>
      <input id="q" type="search" placeholder="Rechercher un produit, un ingrÃ©dient, un allergÃ¨neâ€¦" autocomplete="off" />
      <select id="nutri">
        <option value="">Nutri-Score (tous)</option>
        <option>A</option><option>B</option><option>C</option><option>D</option><option>E</option>
      </select>
      <select id="eco">
        <option value="">Ã‰co-Score (tous)</option>
        <option>A</option><option>B</option><option>C</option><option>D</option><option>E</option>
        <option value="NA">Sans Ã©co-score</option>
      </select>
    </div>
  </div>
</header>

<main class="container">
  <div id="grid" class="grid" aria-live="polite"></div>
  <div id="empty" class="empty" style="display:none">Aucun produit ne correspond Ã  votre recherche.</div>
</main>

<footer class="footer">
  DonnÃ©es fournies par l'exploitant â€” Informations indicatives, se rÃ©fÃ©rer Ã  l'emballage en cas de doute.
</footer>

<script>
  // ðŸ‘‰ REMPLACE ICI par l'URL de TON LOGO (PNG/SVG/JPG). Laisse vide pour le badge "MG".
  const LOGO_URL = "https://drive.google.com/file/d/199NY6wLn3sgSQ-6FXkeSzTTrY9Bfx3Cb/view?usp=drive_link";

  const DATA = [{"id": 1, "produit": "Kinder Bueno", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Chocolat au lait (sucre, beurre de cacao, pÃ¢te de cacao, lait Ã©crÃ©mÃ© en poudre,\n beurre concentrÃ©, lÃ©cithine de soja, vanilline), sucre, huile de palme, farine de froment, \nnoisettes (10,8 %), lait Ã©crÃ©mÃ© en poudre, cacao maigre, poudres Ã  lever, sel, vanilline", "allergenes": ["['Lait', 'gluten', 'noisettes', 'soja']"], "nutriscore": "E", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 2, "produit": "Cristaline", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Eau de source Cristaline", "allergenes": ["[]"], "nutriscore": "A", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 3, "produit": "Volvic aromatisÃ©e", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Eau minÃ©rale naturelle Volvic (â‰ˆ 98,5 %), sucre (~ 1 %), arÃ´me naturel (ex. citron) + \nacidifiant : acide citrique", "allergenes": ["[]"], "nutriscore": "C", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 4, "produit": "KitKat", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Sucre, farine de blÃ©, beurre de cacao, lait Ã©crÃ©mÃ© en poudre, huile de palme, pÃ¢te de \ncacao, beurre pÃ¢tissier, petit-lait en poudre, cacao maigre, Ã©mulsifiant (lÃ©cithine de soja \nou tournesol), arÃ´me naturel de vanille, sel, poudre Ã  lever", "allergenes": ["['Lait', 'gluten', 'soja']"], "nutriscore": "E", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 5, "produit": "Fuze Tea Slim", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Eau, thÃ© (extraits), sucre, arÃ´mes naturels, acidifiants (acide citrique, citratesâ€¦), \nconservateurs, Ã©dulcorants (ex : sucralose, acÃ©sulfame-K)", "allergenes": ["[]"], "nutriscore": "D", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 6, "produit": "Coca Slim", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Eau gazÃ©ifiÃ©e, sucre, colorant caramel (E150d), acide phosphorique, arÃ´mes naturels, cafÃ©ine", "allergenes": ["[]"], "nutriscore": "E", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 7, "produit": "Madeleines natures", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Farine de blÃ©, huile de colza, sucre, Å“ufs, stabilisant (glycÃ©rol, sorbitol), sirop de glucose-fructose, \nÃ©mulsifiant (mono- et diglycÃ©rides dâ€™acides gras, lÃ©cithine de soja), poudres Ã  lever (diphosphates, \ncarbonates de sodium), sel, fÃ©cule, arÃ´me", "allergenes": ["['Gluten (blÃ©)', 'Å“ufs', 'soja', 'traces possibles : lait', 'fruits Ã  coque']"], "nutriscore": "D", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 8, "produit": "M&M's", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Sucre, cacao maigre, beurre de cacao, lait Ã©crÃ©mÃ© en poudre, lactose, sirop de glucose, amidon de maÃ¯s,\n huile (palme, ou autres huiles vÃ©gÃ©tales), Ã©mulsifiants (lÃ©cithine de soja), colorants, arÃ´mes, sel", "allergenes": ["['Lait', 'soja', 'traces possibles : fruits Ã  \\ncoque', 'gluten']"], "nutriscore": "E", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 9, "produit": "Bahia", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Jus et purÃ©es de fruits Ã  base de concentrÃ©s (en fonction des arÃ´mes ~ 35 %, ~ 20 %, ~ 10 %), eau, \nextrait de matÃ© (0,24 %), acidifiant (acide citrique), arÃ´me naturel", "allergenes": ["[]"], "nutriscore": "C", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 10, "produit": "Clipper", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Eau, jus de fruits Ã  base de concentrÃ©, arÃ´mes naturels", "allergenes": ["[]"], "nutriscore": "nan", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 11, "produit": "Coca Zero Slim", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Eau gazÃ©ifiÃ©e, colorant caramel (E150d), acidifiants (acide phosphorique, citrates), Ã©dulcorants \n(aspartame, acÃ©sulfame-K), arÃ´mes, cafÃ©ine", "allergenes": ["['Contient une source de phÃ©nylalanine \\n(liÃ© Ã  lâ€™aspartame)']"], "nutriscore": "B", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 12, "produit": "Bos", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Eau, sucre de canne*, rÃ©gulateur dâ€™aciditÃ© (acide citrique), extrait de rooibos* (0,1 %), arÃ´me naturel", "allergenes": ["[]"], "nutriscore": "B", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 13, "produit": "Grand cookie moelleux", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Flocons dâ€™avoine, sucre de canne, huile de tournesol, farine de blÃ©, pÃ©pites de chocolat (sucre de canne, \npÃ¢te de cacao, beurre de cacao), sirop de riz, poudres Ã  lever (bicarbonate de sodium), sel marin. \n(IngrÃ©dients issus de lâ€™agriculture biologique)", "allergenes": ["['Gluten', 'soja (dans le chocolat)', 'traces possibles de lait et fruits Ã  coque.']"], "nutriscore": "C", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 14, "produit": "Twix", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Sucre, sirop de glucose, farine de blÃ© (â‰ˆ 17 %), matiÃ¨re grasse de palme, beurre de cacao, lait Ã©crÃ©mÃ© en \npoudre, pÃ¢te de cacao, lactose, beurre concentrÃ©, petit-lait en poudre, cacao maigre, sel, Ã©mulsifiant \n(lÃ©cithine de soja), poudre Ã  lever, extrait naturel de vanille", "allergenes": ["['Lait', 'gluten', 'soja (et peut contenir traces \\nde cacahuÃ¨tes', 'amandes', 'noisettes)']"], "nutriscore": "E", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 15, "produit": "Gaufres LiÃ©geoises", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Farine de froment, sucre (â‰ˆ 24,5 %), margarine (huiles vÃ©gÃ©tales palme/colza, eau, Ã©mulsifiants, sel, \ncorrecteur dâ€™aciditÃ©), Å“ufs, levure, farine de soja, sucre inverti, stabilisant (sorbitol), sel, arÃ´me", "allergenes": ["['Gluten', 'Å“ufs', 'soja (et traces possibles \\nde lait)']"], "nutriscore": "nan", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 16, "produit": "Gaufres au miel Bjorg", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Farine de blÃ© semi-complÃ¨te, sucre, miel (12 %), margarine (huiles vÃ©gÃ©tales, eau, Ã©mulsifiants), sirop de \nsucre inverti, Å“uf en poudre, sel, Ã©mulsifiant (lÃ©cithine tournesol), agent levant", "allergenes": ["['Gluten', 'Å“ufs', 'traces possibles de lait', 'fruits Ã  coque', 'soja']"], "nutriscore": "C", "ecoscore": "B", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 17, "produit": "Chips BCBG", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Pommes de terre, huile de tournesol olÃ©ique, sel", "allergenes": ["[]"], "nutriscore": "E", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 18, "produit": "Petits cookies franÃ§ais", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Farine de blÃ©, sucre, huile de colza, Ã©clats de chocolat (pÃ¢te de cacao, sucre, beurre de cacao), Å“ufs, sirop de \nglucose-fructose, poudres Ã  lever, sel, arÃ´me naturel de vanille.", "allergenes": ["['Gluten', 'Å“ufs', 'soja', 'lait (traces possibles)']"], "nutriscore": "D", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 19, "produit": "Perrier Slim", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Eau minÃ©rale gazeuse, dioxyde de carbone, arÃ´me naturel", "allergenes": ["[]"], "nutriscore": "A", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 20, "produit": "7up", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Eau gazÃ©ifiÃ©e, sucre, acidifiants (acide citrique), arÃ´mes, correcteurs dâ€™aciditÃ© (citrates)", "allergenes": ["[]"], "nutriscore": "E", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 21, "produit": "Haribo mix", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Sirop de glucose, sucre, gÃ©latine, farine de blÃ©, dextrose, amidons (maÃ¯s, blÃ©), acidifiants (acide citrique, \nacide malique), correcteurs dâ€™aciditÃ©, arÃ´mes, concentrÃ©s de fruits/plantes, colorants, agents dâ€™enrobage, \ncire dâ€™abeille, cire de carnauba, graisse de palme, Ã©mulsifiants, amidon modifiÃ©", "allergenes": ["['Gluten (blÃ©)', 'lait (traces possibles)']"], "nutriscore": "E", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 22, "produit": "Madeleines marbrÃ©es", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Farine de blÃ©, sucre, huile de colza, Å“ufs, sirop de glucose-fructose, lait demi-Ã©crÃ©mÃ©, arÃ´me naturel de \nvanille, poudres Ã  lever, sel", "allergenes": ["['Gluten', 'Å“ufs', 'lait']"], "nutriscore": "D", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 23, "produit": "Compotes Gourde", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "100 % fruits (ex. mixÃ© du verger pomme, poire, pÃªche) sans sucres ajoutÃ©s ni colorants", "allergenes": ["[]"], "nutriscore": "A", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 24, "produit": "Chips Too Good", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Farine de soja (30 %), amidon de tapioca, pomme de terre dÃ©shydratÃ©e (13 %), huile de tournesol, amidon \nde pomme de terre, sel, arÃ´me, Ã©pices, exhausteurs de goÃ»t", "allergenes": ["['Soja']"], "nutriscore": "E", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 25, "produit": "FourrÃ©s Choco Noir", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Farine de blÃ©, chocolat noir (masse de cacao, sucre de canne, beurre de cacao), sucre de canne non raffinÃ©, \nfarine complÃ¨te de blÃ©*, huile de tournesol olÃ©ique, arÃ´me naturel de vanille, lait Ã©crÃ©mÃ© en poudre, sel marin, \npoudres Ã  lever (carbonates dâ€™ammonium, carbonates de sodium), gomme dâ€™acacia, antioxydant", "allergenes": ["['Gluten', 'lait', 'peut contenir traces dâ€™Å“ufs', 'fruits Ã  coque', 'sÃ©same']"], "nutriscore": "D", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 26, "produit": "Snickers", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Sucre, sirop de glucose, cacahuÃ¨tes, lait Ã©crÃ©mÃ© en poudre, beurre de cacao, pÃ¢te de cacao, \nhuile de tournesol, beurre concentrÃ© (lait), petit-lait en poudre, matiÃ¨re grasse de palme, sel, Ã©mulsifiant \n(lÃ©cithine de soja), blanc dâ€™Å“uf en poudre, huile de noix de coco, protÃ©ine de lait hydrolysÃ©e, arÃ´me naturel \nde vanille", "allergenes": ["['Arachides (cacahuÃ¨tes)', 'lait', 'soja', 'Å“uf', 'traces possibles de fruits Ã  coque']"], "nutriscore": "E", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 27, "produit": "GerblÃ© Choco", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Farine de blÃ©, sucre, huile de colza, germe de blÃ©, pÃ©pites de chocolat (avec pÃ¢te de cacao, sucre, beurre de \ncacao, Ã©mulsifiant lÃ©cithine de soja), lait fermentÃ© poudre, amidon, fibres dâ€™avoine, poudres Ã  lever, \narÃ´me naturel, sel", "allergenes": ["['Gluten', 'lait', 'Å“ufs', 'soja', 'noisettes \\n(fruits Ã  coque) (traces possibles)']"], "nutriscore": "C", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 28, "produit": "Crackers Bon Papa", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Farine de blÃ©, huile de tournesol haute teneur en acide olÃ©ique, sel, huile dâ€™olive extra-vierge 2 %, \ntomate dÃ©shydratÃ©e, origan, oignon dÃ©shydratÃ©, basilic, graines de sÃ©same", "allergenes": ["['Gluten', 'sÃ©same (traces possibles de \\nlait', 'soja', 'moutarde', 'fruits Ã  coque)']"], "nutriscore": "nan", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 29, "produit": "Noot's", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Figues sÃ©chÃ©es (â‰ˆ 21,5 %), farine de riz, flocons dâ€™avoine, amandes grillÃ©es (â‰ˆ 14 %), miel (â‰ˆ 9 %), graines \ndiverses, sirop (glucose, etc.), arÃ´mes naturels, huile de tournesol, sel", "allergenes": ["['Fruits Ã  coque (amandes)', 'gluten (avoine)']"], "nutriscore": "C", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 30, "produit": "Galettes de Riz Choco", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Chocolat noir 50 % (pÃ¢te de cacao, sucre, beurre de cacao), riz brun 42,5 %, brisures de riz blanc 7,5 % \n(ingrÃ©dients biologiques)", "allergenes": ["['Peut contenir du soja (dans le chocolat)']"], "nutriscore": "C", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}];

  const $ = (sel) => document.querySelector(sel);
  const grid = $("#grid");
  const empty = $("#empty");
  const q = $("#q");
  const nutri = $("#nutri");
  const eco = $("#eco");

  // Insert logo if provided
  const brandSlot = document.getElementById("brandSlot");
  if (LOGO_URL) {
    brandSlot.className = "brand-img";
    brandSlot.innerHTML = `<img src="${LOGO_URL}" alt="Logo" />`;
  }

  function normalize(str) {
    return (str || "").toString().toLowerCase().normalize("NFD").replace(/\p{Diacritic}/gu, "");
  }

  function productCard(p) {
    const allergens = (p.allergenes || []).map(a => `<span class="chip">${a}</span>`).join(" ");
    const nutri = p.nutriscore ? `<span class="score" data-type="nutri" data-value="${p.nutriscore}">Nutri-${p.nutriscore}</span>` : "";
    const eco = p.ecoscore ? `<span class="score" data-type="eco" data-value="${p.ecoscore}">Ã‰co-${p.ecoscore}</span>` : `<span class="chip">Ã‰co-N/A</span>`;
    return `
      <article class="card">
        <h3>${p.produit || "Sans nom"}</h3>
        <div class="row muted">${nutri} ${eco} ${p.poids_volume ? `<span class="chip">${p.poids_volume}</span>` : ""}</div>
        <div class="muted">${p.ingredients || "â€”"}</div>
        <div class="row">${allergens}</div>
      </article>
    `;
  }

  function applyFilters() {
    const term = normalize(q.value);
    const ns = nutri.value;
    const es = eco.value;

    const out = DATA.filter(p => {
      if (!(p.disponible_lyon2 || (p.site||"").toLowerCase().includes("lyon 2"))) return false;
      if (ns && (p.nutriscore||"") !== ns) return false;
      if (es) {
        if (es === "NA" && (p.ecoscore||"") !== "") return false;
        if (es !== "NA" && (p.ecoscore||"") !== es) return false;
      }
      if (!term) return true;
      const hay = normalize([p.produit, p.ingredients, (p.allergenes||[]).join(" "), p.categorie].join(" "));
      return hay.includes(term);
    });

    grid.innerHTML = out.map(productCard).join("");
    empty.style.display = out.length ? "none" : "block";
  }

  q.addEventListener("input", applyFilters);
  nutri.addEventListener("change", applyFilters);
  eco.addEventListener("change", applyFilters);
  applyFilters();
</script>
</body>
</html>
