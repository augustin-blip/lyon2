<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Produits Lyon 2 ‚Äî Infos & Allerg√®nes</title>
<meta name="description" content="Liste des produits disponibles √† Lyon 2 avec ingr√©dients, allerg√®nes, Nutri-Score et √âco-Score." />
<style>
  :root {
    --bg:#f6fdf8; --card:#ffffff; --muted:#476154; --text:#0b1f14;
    --accent:#22c55e; --accent-2:#10b981; --chip:#e8f7ee; --border:#def7e6; --ring:rgba(34,197,94,.35);
  }
  * { box-sizing:border-box; }
  body { margin:0; background:var(--bg); color:var(--text); font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; }
  header { position:sticky; top:0; z-index:20; backdrop-filter:saturate(1.2) blur(8px); background:rgba(246,253,248,.9); border-bottom:1px solid var(--border); }
  .container { max-width:1100px; margin:0 auto; padding:16px; }
  .title { display:flex; align-items:center; gap:12px; flex-wrap:wrap; }
  .logo, .brand-img { width:32px; height:32px; border-radius:8px; background:linear-gradient(135deg,var(--accent),var(--accent-2)); display:inline-flex; align-items:center; justify-content:center; color:white; font-weight:800; }
  .brand-img { background:none; }
  .brand-img img { max-height:32px; max-width:120px; height:auto; width:auto; display:block; object-fit:contain; }
  .title h1 { margin:0; font-size:1.15rem; }
  .badge { font-size:.75rem; padding:2px 8px; border-radius:999px; background:var(--chip); color:var(--muted); border:1px solid var(--border); }
  .ctrls { display:grid; grid-template-columns:1fr; gap:10px; margin-top:10px; }
  @media (min-width:720px) { .ctrls { grid-template-columns:1fr 200px 200px; } }
  input[type="search"], select { width:100%; padding:12px 14px; border-radius:12px; border:1px solid var(--border); background:var(--card); color:var(--text); outline:none; }
  input[type="search"]:focus, select:focus { box-shadow:0 0 0 4px var(--ring); border-color:var(--accent); }
  main.container { padding-top:12px; }
  .grid { display:grid; grid-template-columns:1fr; gap:14px; }
  @media (min-width:640px) { .grid { grid-template-columns:repeat(2,minmax(0,1fr)); } }
  @media (min-width:980px) { .grid { grid-template-columns:repeat(3,minmax(0,1fr)); } }
  .card { background:var(--card); border:1px solid var(--border); border-radius:16px; padding:14px; display:flex; flex-direction:column; gap:10px; box-shadow: 0 6px 16px rgba(34,197,94, .06); }
  .card h3 { margin:0; font-size:1.02rem; }
  .muted { color:var(--muted); font-size:.9rem; }
  .row { display:flex; align-items:center; gap:8px; flex-wrap:wrap; }
  .chip { background:var(--chip); border:1px solid var(--border); padding:2px 8px; border-radius:999px; font-size:.8rem; }
  .score { font-weight:700; padding:2px 8px; border-radius:8px; border:1px solid var(--border); background:var(--chip); }
  .score[data-type="nutri"][data-value="A"] { background:#eafbf0; border-color:#a7f3d0; }
  .score[data-type="nutri"][data-value="B"] { background:#f0fde8; border-color:#c7f9b5; }
  .score[data-type="nutri"][data-value="C"] { background:#fffbe6; border-color:#fde68a; }
  .score[data-type="nutri"][data-value="D"] { background:#fff1e6; border-color:#fdba74; }
  .score[data-type="nutri"][data-value="E"] { background:#ffecec; border-color:#fca5a5; }
  .score[data-type="eco"][data-value="A"] { background:#eafbf0; border-color:#a7f3d0; }
  .score[data-type="eco"][data-value="B"] { background:#f0fde8; border-color:#c7f9b5; }
  .score[data-type="eco"][data-value="C"] { background:#fffbe6; border-color:#fde68a; }
  .score[data-type="eco"][data-value="D"] { background:#fff1e6; border-color:#fdba74; }
  .score[data-type="eco"][data-value="E"] { background:#ffecec; border-color:#fca5a5; }
  .footer { text-align:center; color:var(--muted); font-size:.8rem; padding:20px 0 40px; }
  .empty { text-align:center; padding:40px; border:1px dashed var(--border); border-radius:16px; color:var(--muted); }
  .sr { position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); border:0; }
  .pill { display:inline-flex; align-items:center; gap:6px; padding:2px 8px; border-radius:999px; background:linear-gradient(135deg,var(--accent),var(--accent-2)); color:white; font-size:.8rem; font-weight:700; }
</style>
</head>
<body>
<header>
  <div class="container">
    <div class="title">
      <div id="brandSlot" class="logo">MG</div>
      <h1>Produits disponibles ‚Äî Lyon 2</h1>
      <span class="badge">MAJ 2025-10-07</span>
      <span class="pill">My Green Shop</span>
    </div>
    <div class="ctrls" role="search">
      <label class="sr" for="q">Recherche</label>
      <input id="q" type="search" placeholder="Rechercher un produit, un ingr√©dient, un allerg√®ne‚Ä¶" autocomplete="off" />
      <select id="nutri">
        <option value="">Nutri-Score (tous)</option>
        <option>A</option><option>B</option><option>C</option><option>D</option><option>E</option>
      </select>
      <select id="eco">
        <option value="">√âco-Score (tous)</option>
        <option>A</option><option>B</option><option>C</option><option>D</option><option>E</option>
        <option value="NA">Sans √©co-score</option>
      </select>
    </div>
  </div>
</header>

<main class="container">
  <div id="grid" class="grid" aria-live="polite"></div>
  <div id="empty" class="empty" style="display:none">Aucun produit ne correspond √† votre recherche.</div>
</main>

<footer class="footer">
  Donn√©es fournies par l'exploitant ‚Äî Informations indicatives, se r√©f√©rer √† l'emballage en cas de doute.
</footer>

<script>
  // üëâ REMPLACE ICI par l'URL de TON LOGO (PNG/SVG/JPG). Laisse vide pour le badge "MG".
  const LOGO_URL = "https://drive.google.com/file/d/199NY6wLn3sgSQ-6FXkeSzTTrY9Bfx3Cb/view?usp=drive_link";

  const DATA = [{"id": 1, "produit": "Kinder Bueno", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Chocolat au lait (sucre, beurre de cacao, p√¢te de cacao, lait √©cr√©m√© en poudre,\n beurre concentr√©, l√©cithine de soja, vanilline), sucre, huile de palme, farine de froment, \nnoisettes (10,8 %), lait √©cr√©m√© en poudre, cacao maigre, poudres √† lever, sel, vanilline", "allergenes": ["['Lait', 'gluten', 'noisettes', 'soja']"], "nutriscore": "E", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 2, "produit": "Cristaline", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Eau de source Cristaline", "allergenes": ["[]"], "nutriscore": "A", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 3, "produit": "Volvic aromatis√©e", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Eau min√©rale naturelle Volvic (‚âà 98,5 %), sucre (~ 1 %), ar√¥me naturel (ex. citron) + \nacidifiant : acide citrique", "allergenes": ["[]"], "nutriscore": "C", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 4, "produit": "KitKat", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Sucre, farine de bl√©, beurre de cacao, lait √©cr√©m√© en poudre, huile de palme, p√¢te de \ncacao, beurre p√¢tissier, petit-lait en poudre, cacao maigre, √©mulsifiant (l√©cithine de soja \nou tournesol), ar√¥me naturel de vanille, sel, poudre √† lever", "allergenes": ["['Lait', 'gluten', 'soja']"], "nutriscore": "E", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 5, "produit": "Fuze Tea Slim", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Eau, th√© (extraits), sucre, ar√¥mes naturels, acidifiants (acide citrique, citrates‚Ä¶), \nconservateurs, √©dulcorants (ex : sucralose, ac√©sulfame-K)", "allergenes": ["[]"], "nutriscore": "D", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 6, "produit": "Coca Slim", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Eau gaz√©ifi√©e, sucre, colorant caramel (E150d), acide phosphorique, ar√¥mes naturels, caf√©ine", "allergenes": ["[]"], "nutriscore": "E", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 7, "produit": "Madeleines natures", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Farine de bl√©, huile de colza, sucre, ≈ìufs, stabilisant (glyc√©rol, sorbitol), sirop de glucose-fructose, \n√©mulsifiant (mono- et diglyc√©rides d‚Äôacides gras, l√©cithine de soja), poudres √† lever (diphosphates, \ncarbonates de sodium), sel, f√©cule, ar√¥me", "allergenes": ["['Gluten (bl√©)', '≈ìufs', 'soja', 'traces possibles : lait', 'fruits √† coque']"], "nutriscore": "D", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 8, "produit": "M&M's", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Sucre, cacao maigre, beurre de cacao, lait √©cr√©m√© en poudre, lactose, sirop de glucose, amidon de ma√Øs,\n huile (palme, ou autres huiles v√©g√©tales), √©mulsifiants (l√©cithine de soja), colorants, ar√¥mes, sel", "allergenes": ["['Lait', 'soja', 'traces possibles : fruits √† \\ncoque', 'gluten']"], "nutriscore": "E", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 9, "produit": "Bahia", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Jus et pur√©es de fruits √† base de concentr√©s (en fonction des ar√¥mes ~ 35 %, ~ 20 %, ~ 10 %), eau, \nextrait de mat√© (0,24 %), acidifiant (acide citrique), ar√¥me naturel", "allergenes": ["[]"], "nutriscore": "C", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 10, "produit": "Clipper", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Eau, jus de fruits √† base de concentr√©, ar√¥mes naturels", "allergenes": ["[]"], "nutriscore": "nan", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 11, "produit": "Coca Zero Slim", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Eau gaz√©ifi√©e, colorant caramel (E150d), acidifiants (acide phosphorique, citrates), √©dulcorants \n(aspartame, ac√©sulfame-K), ar√¥mes, caf√©ine", "allergenes": ["['Contient une source de ph√©nylalanine \\n(li√© √† l‚Äôaspartame)']"], "nutriscore": "B", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 12, "produit": "Bos", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Eau, sucre de canne*, r√©gulateur d‚Äôacidit√© (acide citrique), extrait de rooibos* (0,1 %), ar√¥me naturel", "allergenes": ["[]"], "nutriscore": "B", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 13, "produit": "Grand cookie moelleux", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Flocons d‚Äôavoine, sucre de canne, huile de tournesol, farine de bl√©, p√©pites de chocolat (sucre de canne, \np√¢te de cacao, beurre de cacao), sirop de riz, poudres √† lever (bicarbonate de sodium), sel marin. \n(Ingr√©dients issus de l‚Äôagriculture biologique)", "allergenes": ["['Gluten', 'soja (dans le chocolat)', 'traces possibles de lait et fruits √† coque.']"], "nutriscore": "C", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 14, "produit": "Twix", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Sucre, sirop de glucose, farine de bl√© (‚âà 17 %), mati√®re grasse de palme, beurre de cacao, lait √©cr√©m√© en \npoudre, p√¢te de cacao, lactose, beurre concentr√©, petit-lait en poudre, cacao maigre, sel, √©mulsifiant \n(l√©cithine de soja), poudre √† lever, extrait naturel de vanille", "allergenes": ["['Lait', 'gluten', 'soja (et peut contenir traces \\nde cacahu√®tes', 'amandes', 'noisettes)']"], "nutriscore": "E", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 15, "produit": "Gaufres Li√©geoises", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Farine de froment, sucre (‚âà 24,5 %), margarine (huiles v√©g√©tales palme/colza, eau, √©mulsifiants, sel, \ncorrecteur d‚Äôacidit√©), ≈ìufs, levure, farine de soja, sucre inverti, stabilisant (sorbitol), sel, ar√¥me", "allergenes": ["['Gluten', '≈ìufs', 'soja (et traces possibles \\nde lait)']"], "nutriscore": "nan", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 16, "produit": "Gaufres au miel Bjorg", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Farine de bl√© semi-compl√®te, sucre, miel (12 %), margarine (huiles v√©g√©tales, eau, √©mulsifiants), sirop de \nsucre inverti, ≈ìuf en poudre, sel, √©mulsifiant (l√©cithine tournesol), agent levant", "allergenes": ["['Gluten', '≈ìufs', 'traces possibles de lait', 'fruits √† coque', 'soja']"], "nutriscore": "C", "ecoscore": "B", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 17, "produit": "Chips BCBG", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Pommes de terre, huile de tournesol ol√©ique, sel", "allergenes": ["[]"], "nutriscore": "E", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 18, "produit": "Petits cookies fran√ßais", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Farine de bl√©, sucre, huile de colza, √©clats de chocolat (p√¢te de cacao, sucre, beurre de cacao), ≈ìufs, sirop de \nglucose-fructose, poudres √† lever, sel, ar√¥me naturel de vanille.", "allergenes": ["['Gluten', '≈ìufs', 'soja', 'lait (traces possibles)']"], "nutriscore": "D", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 19, "produit": "Perrier Slim", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Eau min√©rale gazeuse, dioxyde de carbone, ar√¥me naturel", "allergenes": ["[]"], "nutriscore": "A", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 20, "produit": "7up", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Eau gaz√©ifi√©e, sucre, acidifiants (acide citrique), ar√¥mes, correcteurs d‚Äôacidit√© (citrates)", "allergenes": ["[]"], "nutriscore": "E", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 21, "produit": "Haribo mix", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Sirop de glucose, sucre, g√©latine, farine de bl√©, dextrose, amidons (ma√Øs, bl√©), acidifiants (acide citrique, \nacide malique), correcteurs d‚Äôacidit√©, ar√¥mes, concentr√©s de fruits/plantes, colorants, agents d‚Äôenrobage, \ncire d‚Äôabeille, cire de carnauba, graisse de palme, √©mulsifiants, amidon modifi√©", "allergenes": ["['Gluten (bl√©)', 'lait (traces possibles)']"], "nutriscore": "E", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 22, "produit": "Madeleines marbr√©es", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Farine de bl√©, sucre, huile de colza, ≈ìufs, sirop de glucose-fructose, lait demi-√©cr√©m√©, ar√¥me naturel de \nvanille, poudres √† lever, sel", "allergenes": ["['Gluten', '≈ìufs', 'lait']"], "nutriscore": "D", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 23, "produit": "Compotes Gourde", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "100 % fruits (ex. mix√© du verger pomme, poire, p√™che) sans sucres ajout√©s ni colorants", "allergenes": ["[]"], "nutriscore": "A", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 24, "produit": "Chips Too Good", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Farine de soja (30 %), amidon de tapioca, pomme de terre d√©shydrat√©e (13 %), huile de tournesol, amidon \nde pomme de terre, sel, ar√¥me, √©pices, exhausteurs de go√ªt", "allergenes": ["['Soja']"], "nutriscore": "E", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 25, "produit": "Fourr√©s Choco Noir", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Farine de bl√©, chocolat noir (masse de cacao, sucre de canne, beurre de cacao), sucre de canne non raffin√©, \nfarine compl√®te de bl√©*, huile de tournesol ol√©ique, ar√¥me naturel de vanille, lait √©cr√©m√© en poudre, sel marin, \npoudres √† lever (carbonates d‚Äôammonium, carbonates de sodium), gomme d‚Äôacacia, antioxydant", "allergenes": ["['Gluten', 'lait', 'peut contenir traces d‚Äô≈ìufs', 'fruits √† coque', 's√©same']"], "nutriscore": "D", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 26, "produit": "Snickers", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Sucre, sirop de glucose, cacahu√®tes, lait √©cr√©m√© en poudre, beurre de cacao, p√¢te de cacao, \nhuile de tournesol, beurre concentr√© (lait), petit-lait en poudre, mati√®re grasse de palme, sel, √©mulsifiant \n(l√©cithine de soja), blanc d‚Äô≈ìuf en poudre, huile de noix de coco, prot√©ine de lait hydrolys√©e, ar√¥me naturel \nde vanille", "allergenes": ["['Arachides (cacahu√®tes)', 'lait', 'soja', '≈ìuf', 'traces possibles de fruits √† coque']"], "nutriscore": "E", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 27, "produit": "Gerbl√© Choco", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Farine de bl√©, sucre, huile de colza, germe de bl√©, p√©pites de chocolat (avec p√¢te de cacao, sucre, beurre de \ncacao, √©mulsifiant l√©cithine de soja), lait ferment√© poudre, amidon, fibres d‚Äôavoine, poudres √† lever, \nar√¥me naturel, sel", "allergenes": ["['Gluten', 'lait', '≈ìufs', 'soja', 'noisettes \\n(fruits √† coque) (traces possibles)']"], "nutriscore": "C", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 28, "produit": "Crackers Bon Papa", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Farine de bl√©, huile de tournesol haute teneur en acide ol√©ique, sel, huile d‚Äôolive extra-vierge 2 %, \ntomate d√©shydrat√©e, origan, oignon d√©shydrat√©, basilic, graines de s√©same", "allergenes": ["['Gluten', 's√©same (traces possibles de \\nlait', 'soja', 'moutarde', 'fruits √† coque)']"], "nutriscore": "nan", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 29, "produit": "Noot's", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Figues s√©ch√©es (‚âà 21,5 %), farine de riz, flocons d‚Äôavoine, amandes grill√©es (‚âà 14 %), miel (‚âà 9 %), graines \ndiverses, sirop (glucose, etc.), ar√¥mes naturels, huile de tournesol, sel", "allergenes": ["['Fruits √† coque (amandes)', 'gluten (avoine)']"], "nutriscore": "C", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}, {"id": 30, "produit": "Galettes de Riz Choco", "categorie": "nan", "site": "Lyon 2", "disponible_lyon2": true, "ingredients": "Chocolat noir 50 % (p√¢te de cacao, sucre, beurre de cacao), riz brun 42,5 %, brisures de riz blanc 7,5 % \n(ingr√©dients biologiques)", "allergenes": ["['Peut contenir du soja (dans le chocolat)']"], "nutriscore": "C", "ecoscore": "nan", "poids_volume": "nan", "prix_eur": null, "image_url": "nan", "url_produit": "nan"}];

  const $ = (sel) => document.querySelector(sel);
  const grid = $("#grid");
  const empty = $("#empty");
  const q = $("#q");
  const nutri = $("#nutri");
  const eco = $("#eco");

  // Insert logo if provided
  const brandSlot = document.getElementById("brandSlot");
  if (LOGO_URL) {
    brandSlot.className = "brand-img";
    brandSlot.innerHTML = `<img src="${LOGO_URL}" alt="Logo" />`;
  }

  function normalize(str) {
    return (str || "").toString().toLowerCase().normalize("NFD").replace(/\p{Diacritic}/gu, "");
  }

  function productCard(p) {
    const allergens = (p.allergenes || []).map(a => `<span class="chip">${a}</span>`).join(" ");
    const nutri = p.nutriscore ? `<span class="score" data-type="nutri" data-value="${p.nutriscore}">Nutri-${p.nutriscore}</span>` : "";
    const eco = p.ecoscore ? `<span class="score" data-type="eco" data-value="${p.ecoscore}">√âco-${p.ecoscore}</span>` : `<span class="chip">√âco-N/A</span>`;
    return `
      <article class="card">
        <h3>${p.produit || "Sans nom"}</h3>
        <div class="row muted">${nutri} ${eco} ${p.poids_volume ? `<span class="chip">${p.poids_volume}</span>` : ""}</div>
        <div class="muted">${p.ingredients || "‚Äî"}</div>
        <div class="row">${allergens}</div>
      </article>
    `;
  }

  function applyFilters() {
    const term = normalize(q.value);
    const ns = nutri.value;
    const es = eco.value;

    const out = DATA.filter(p => {
      if (!(p.disponible_lyon2 || (p.site||"").toLowerCase().includes("lyon 2"))) return false;
      if (ns && (p.nutriscore||"") !== ns) return false;
      if (es) {
        if (es === "NA" && (p.ecoscore||"") !== "") return false;
        if (es !== "NA" && (p.ecoscore||"") !== es) return false;
      }
      if (!term) return true;
      const hay = normalize([p.produit, p.ingredients, (p.allergenes||[]).join(" "), p.categorie].join(" "));
      return hay.includes(term);
    });

    grid.innerHTML = out.map(productCard).join("");
    empty.style.display = out.length ? "none" : "block";
  }

  q.addEventListener("input", applyFilters);
  nutri.addEventListener("change", applyFilters);
  eco.addEventListener("change", applyFilters);
  applyFilters();
</script>
</body>
</html>
